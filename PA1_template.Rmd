---
title: "First_Knitr"
author: "EHarris"
date: "5/25/2017"
output: html_document
---

## Set Global Option
```{r setoptions, echo = FALSE}
opts_chunk$set(echo = FALSE, results = asis, include = TRUE)
```

## Load anticipated packages to be used throughout Course 5 Project 1
```{r setup, include=TRUE}
ipak <- function(pkg){
      new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
      if (length(new.pkg)) 
            install.packages(new.pkg, dependencies = TRUE)
      sapply(pkg, require, character.only = TRUE)
}

### Package Usage
packages <- c("plyr", "dplyr", "data.table", "dtplyr", "lubridate", "ggplot2", "knitr")
ipak(packages)
```

## Item 1: Code for reading in the dataset and/or processing the data
###   Step 1: Read csv file into R
```{r fileload, include = TRUE}
activity <- read.csv("activity.csv", header = TRUE)
```

###   Step 2: Process data to address other parts of assignment
```{r iniital_processing, include = TRUE}
activity$date1 <- as.Date(activity$date, format = "%Y-%m-%d")
activity$day <- weekdays(activity$date1)
activity$daytype <- ifelse(activity$day %in% c("Saturday", "Sunday"), "Weekend", "Weekday")
activity$date1 <- format(activity$date1, format = "%Y%m%d")
activity$date2 <- format(activity$date1, format = "%Y%b%d")
activity$day_int <- paste(activity$day, activity$interval, sep = "_")
activity <- select(activity, daytype, day, date, date1, date2, interval,
                              day_int, steps)
```

## Item 2: Histogram of the total number of steps taken each day

dates <- data.frame(date=unique(activity$date1))
daterange <- c(dates)
min.date <- dates$date[1]
max.date <- dates[length(dates),]


## Item 2. Histogram of the total number of steps taken each day.  Two steps:  
###    Step 1: Summarize data to support requested histogram information  
```{r total_steps_per_day, include = TRUE}
steps.a.day <- aggregate(steps ~ date1, data = activity, FUN = function(x) sum=sum(x))
mrgtotal <- merge(dates[,1], stepaday[,1:2], by = 1, all = TRUE)
```

###    Step 2: Plot histogram reflecting total number of steps by day
```{r steps_per_dzy_hist, fig.keep = "all"", fig.show = "asis" }
with(steps.a.day, plot(date1, steps, main = "Total Steps Each Day", type = "n"))
qplot(date, steps, data = mrgtotal, xlim = c(mrgtotal[1]), geom = "histogram",
            main = "Total Steps Each Day", xlab = "Dates", ylab = "# Steps")
```

## Item 3: Mean & Median steps per day [Days with no steps are excluded]
```{r mean_median_steps_per_day, include = TRUE}
meansteps <- mean(steps.a.day$steps, na.rm = TRUE)
mediansteps <- median(steps.a.day$steps, na.rm = TRUE)
steps.a.day1 <- data.frame("Mean Steps" = meansteps, "Median Steps" = mediansteps)
steps.a.day1
```

## Item 4: Time series (day of week) plot of the average number of steps taken
```{r mean_steps_day_of_week, include = TRUE}
mean.steps.day <- aggregate(steps ~ day, data = activity, 
                                    FUN = function(x) mean=mean(x))
qplot(day, steps, data = mean.steps.day, pch = 20, geom = c("point", "smooth"),
      xlim = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday","Saturday", "Sunday"),
      xlab = "Day of Week", ylab = "Average Number of Steps",
      main = "Average Steps per Day of Week")
```

## Item 5: 5-munite interval with maximum average number of steps
```{r mean_steps_each5, include = TRUE}
steps.each.5min <- aggregate(steps ~ interval, data = activity,
                                    FUN = function(x) meansteps=mean(x))
steps.each.5min <- steps.each.5min[order(steps.each.5min$steps, decreasing = TRUE),]
steps.each.5min[1,]
```

## Item 6: Code to describe and show a strategy for imputing missing data
```
To impute a value that best reflects a missign value there are two parameters  
to be considered: 1) day of week and 2) interval.  We will replace each  
missing value with applicable imputed value.  
```
### Step 1: Calculate the mean steps for each day of week + interval combination  
```{r mean_steps_day_interval, include = TRUE}
mean.day.interval <- aggregate(steps ~ day + interval, data = activity,
                                    FUN = function(x) meansteps=mean(x))
mean.day.interval$day_int <- paste(mean.day.interval$day, mean.day.interval$interval,
                                    sep = "_")
mean.day.interval <- select(day, interval, day_int, steps)
```





### Average number of steps taken per 5 minute interval
```
This can be viewed two ways:  
1. Mean number of steps in a 5-minute interval
2. Mean number of steps for each 5-minute interval(same interval of each day)  
```

#### Mean number of steps in a 5-minute interval
```{r mean_steps_per5, include = TRUE}
steps.per.5min <- aggregate(steps ~ date1 + interval, data = activity,
                                    FUN = function(x) meansteps=mean(x))
steps.per.5min <- steps.per.5min[order(steps.per.5min[,1], steps.per.5min[,2]),]
mean.5min <- mean(steps.per.5min$steps)
mean.5min
```







### Item 8: Panel plot of average number of steps per 5-minute interval  
#### A comparison of weekdays and weekend
```{r panel_plot, include = TRUE}
mean.steps.daytype <- aggregate(steps ~ daytype + interval, data = activity,
                             FUN = function(x) mean=mean(x))
mean.wday <- subset(mean.steps.daytype, daytype == "Weekday")
mean.wend <- subset(mean.steps.daytype, daytype == "Weekend")
min.yrange <- round(min(mean.steps.daytype$steps),0)
max.yrange <- round(max(mean.steps.daytype$steps),0)
yrange <- range(seq(from = min.yrange, to = max.yrange, by = 50))
par(mfrow = c(1, 2), mar = c(4, 4, 2, 1), oma = c(0, 0, 2, 0))
plot(mean.wday$interval, mean.wday$steps, pch = 20, type = "l",
                        xlim = range(0,2500), ylim = yrange, xlab = "", 
                        ylab = "Average Number of Steps", main = "Weekday")
plot(mean.wend$interval, mean.wend$steps, pch = 20, type = "l",
                        xlim = range(0,2500), ylim = yrange, xlab = "",
                        ylab = "", main = "Weekend")
```
